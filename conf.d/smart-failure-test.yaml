# 智能失败处理测试配置
# 演示当某个进程失败时，只有依赖它的进程会被跳过，独立进程继续执行

processes:
  # 第一层：基础服务（无依赖）
  - name: database
    group: infrastructure
    command: 'echo "数据库启动中..."; sleep 2; echo "数据库启动完成"'
    workdir: "/tmp"
    enabled: false

  - name: failing-service
    group: infrastructure  
    command: 'echo "失败服务启动中..."; sleep 1; echo "模拟启动失败"; exit 1'
    workdir: "/tmp"
    enabled: false

  - name: independent-service
    group: infrastructure
    command: 'echo "独立服务启动中..."; sleep 2; echo "独立服务启动完成"'
    workdir: "/tmp"
    enabled: false

  # 第二层：依赖第一层服务
  - name: web-server
    group: application
    command: 'echo "Web服务器启动中..."; sleep 2; echo "Web服务器启动完成"'
    workdir: "/tmp"
    enabled: false
    depends_on: ["database"]

  - name: dependent-on-failing
    group: application
    command: 'echo "依赖失败服务的应用启动中..."; sleep 1; echo "依赖失败服务的应用启动完成"'
    workdir: "/tmp"
    enabled: false
    depends_on: ["failing-service"]

  - name: another-independent
    group: application
    command: 'echo "另一个独立服务启动中..."; sleep 2; echo "另一个独立服务启动完成"'
    workdir: "/tmp"
    enabled: false

  # 第三层：依赖第二层服务
  - name: api-gateway
    group: gateway
    command: 'echo "API网关启动中..."; sleep 1; echo "API网关启动完成"'
    workdir: "/tmp"
    enabled: false
    depends_on: ["web-server"]

  - name: also-depends-on-failing
    group: gateway
    command: 'echo "也依赖失败服务的网关启动中..."; sleep 1; echo "也依赖失败服务的网关启动完成"'
    workdir: "/tmp"
    enabled: false
    depends_on: ["dependent-on-failing"]